"use strict";(self.webpackChunkdzitra=self.webpackChunkdzitra||[]).push([[592],{8265:(E,A,r)=>{r.d(A,{I:()=>n});var a=r(4006),c=r(5938),e=r(3091),t=r(4650),Z=r(5619),C=r(6895),h=r(9602),y=r(9549),I=r(4144);function M(d,m){1&d&&(t.TgZ(0,"h5",31),t._uU(1,"Add New Customer"),t.qZA())}function T(d,m){1&d&&(t.TgZ(0,"h5",31),t._uU(1,"Customer Info"),t.qZA())}function v(d,m){if(1&d&&(t.TgZ(0,"option",32),t._uU(1),t.qZA()),2&d){const o=m.$implicit;t.Q6J("value",o._id),t.xp6(1),t.Oqu(o.name)}}function O(d,m){if(1&d&&(t.TgZ(0,"option",32),t._uU(1),t.qZA()),2&d){const o=m.$implicit;t.Q6J("value",o._id),t.xp6(1),t.Oqu(o.planname)}}function D(d,m){if(1&d&&(t.TgZ(0,"option",32),t._uU(1),t.qZA()),2&d){const o=m.$implicit;t.Q6J("value",o._id),t.xp6(1),t.Oqu(o.name)}}function l(d,m){1&d&&(t.TgZ(0,"button",33),t._uU(1,"Add Customer"),t.qZA())}function _(d,m){1&d&&(t.TgZ(0,"button",33),t._uU(1,"Save"),t.qZA())}function s(d,m){1&d&&(t.TgZ(0,"button",34),t._uU(1," Close"),t.qZA())}let n=(()=>{class d{constructor(o,i,u,p,f){this.fb=o,this.dialog=i,this.http=u,this.dialogRef=p,this.Inputdata=f,this.isEditMode=!1,this.isInfoOnly=!1}ngOnInit(){this.addcustomerForm=this.fb.group({planid:["",a.kI.required],lead_id:["",a.kI.required],onboarded_date:["",a.kI.required],subscription_validity:["",a.kI.required],remind_before:["",a.kI.required],purchase_id:["",a.kI.required],dzitrauser_id:["",a.kI.required]}),this.Inputdata&&null!==this.Inputdata.id&&(this.cusId=this.Inputdata.id,this.isEditMode=!0,this.getData()),this.Inputdata?.isReadonly&&(this.readOnly=!0,this.addcustomerForm.disable()),this.Inputdata?.isInfoscreen&&(this.isInfoOnly=!0,this.addcustomerForm.disable()),this.getPlans(),this.getLeads(),this.getDzitrUsers()}getLeads(){this.http.get("/lead/all/active").subscribe(o=>{1==o.status&&(this.leadList=o.data)})}getPlans(){this.http.get("/plan/all/active/paid").subscribe(o=>{1==o.status&&(this.planList=o.data)})}getDzitrUsers(){this.http.get("/dzitrauser/all/active").subscribe(o=>{1==o.status&&(this.dzitraUserList=o.data)})}getData(){this.http.get(`/customer/${this.cusId}`).subscribe(o=>{if(1==o.status){let i=o.data;this.addcustomerForm.patchValue({lead_id:i.lead_id,planid:i.planid,remind_before:i.remind_before,purchase_id:i.purchase_id,dzitrauser_id:i.dzitrauser_id});let u=new Date(i.onboarded_date),p=new Date(i.subscription_validity);this.addcustomerForm.get("onboarded_date")?.setValue(u),this.addcustomerForm.get("subscription_validity")?.setValue(p)}})}calculatedays(o){let i=o.target.value,u=this.planList.filter(U=>U._id==i),p=new Date,f=p.setDate(p.getDate()+u[0].dayscount),g=new Date(f),b=new Date;this.addcustomerForm.get("onboarded_date")?.setValue(b),this.addcustomerForm.get("subscription_validity")?.setValue(g)}calcdates(o){let i=o.target.value,u=this.addcustomerForm.get("planid")?.value,p=this.planList.filter(b=>b._id==u),f=i.setDate(i.getDate()+p[0].dayscount),g=new Date(f);this.addcustomerForm.get("subscription_validity")?.setValue(g)}onSubmit(o){if(!o.valid)return;let i=o.value;this.cusId?(i._id=this.cusId,this.http.patch("/customer",i).subscribe(u=>{1==u.status&&this.dialogRef.close(1)})):this.http.post("/customer",i).subscribe(u=>{1==u.status?this.dialogRef.close(1):2==u.status&&this.dialog.open(e.e,{data:{title:"User Exists",text:"Are you sure to Sync User?",positivebtn:"Sync",Negativebtn:"Cancel",actions:!0,isSuccess:!1,showOnly:!1},width:"35%"}).afterClosed().subscribe(f=>{if(1==f){let g=o.value;g.sync=!0,this.http.post("/customer",g).subscribe(b=>{1==b.status&&this.dialogRef.close(1)})}})})}editinfo(){this.addcustomerForm.enable(),this.isEditMode=!0,this.readOnly=!1}}return d.\u0275fac=function(o){return new(o||d)(t.Y36(a.qu),t.Y36(c.uw),t.Y36(Z.h),t.Y36(c.so),t.Y36(c.WI))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-add-customer-modal"]],decls:53,vars:14,consts:[[1,"row"],[1,"dialogue-head","col-md-8"],["mat-dialog-title","",4,"ngIf"],[1,"close-Btns","col-md-4"],[1,"card","close-Card",3,"mat-dialog-close"],["src","../../../../../assets/image/fi_x.png","alt",""],[1,"addform-container"],[3,"formGroup","ngSubmit"],[1,"col-md-6"],["for","lead_id",1,"dialogue-label"],["formControlName","lead_id","name","lead_id",1,"w-100","input-Class"],[3,"value",4,"ngFor","ngForOf"],["for","planid",1,"dialogue-label"],["formControlName","planid","name","planid",1,"w-100","input-Class",3,"change"],["for","onboarded_date",1,"dialogue-label"],["appearance","fill",1,"col-md-12","datepickerInput"],["matInput","","formControlName","onboarded_date","name","onboarded_date","placeholder","MM/DD/YYYY",3,"matDatepicker","dateChange"],["matIconSuffix","",3,"for"],["picker",""],["for","subscription_validity",1,"dialogue-label"],["matInput","","formControlName","subscription_validity","name","subscription_validity","placeholder","MM/DD/YYYY",3,"matDatepicker","disabled"],["picker1",""],["for","remind_before",1,"dialogue-label"],["type","text","formControlName","remind_before","name","remind_before",1,"w-100","input-Class"],["for","purchase_id",1,"dialogue-label"],["type","text","formControlName","purchase_id","name","purchase_id",1,"w-100","input-Class"],["for","dzitrauser_id",1,"dialogue-label"],["formControlName","dzitrauser_id","name","dzitrauser_id",1,"w-100","input-Class"],[1,"button","col-md-12"],["type","submit","class","createLead-Btns",4,"ngIf"],["type","submit","class","createLead-Btns",3,"mat-dialog-close",4,"ngIf"],["mat-dialog-title",""],[3,"value"],["type","submit",1,"createLead-Btns"],["type","submit",1,"createLead-Btns",3,"mat-dialog-close"]],template:function(o,i){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,M,2,0,"h5",2),t.YNc(3,T,2,0,"h5",2),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t._UZ(6,"img",5),t.qZA()()(),t.TgZ(7,"div",6)(8,"form",7),t.NdJ("ngSubmit",function(){return i.onSubmit(i.addcustomerForm)}),t.TgZ(9,"div",0)(10,"div",8)(11,"label",9),t._uU(12,"Lead"),t.qZA(),t.TgZ(13,"select",10),t.YNc(14,v,2,2,"option",11),t.qZA()(),t.TgZ(15,"div",8)(16,"label",12),t._uU(17,"Plan"),t.qZA(),t.TgZ(18,"select",13),t.NdJ("change",function(p){return i.calculatedays(p)}),t.YNc(19,O,2,2,"option",11),t.qZA()(),t.TgZ(20,"div",8)(21,"label",14),t._uU(22,"On Board Date"),t.qZA(),t.TgZ(23,"mat-form-field",15)(24,"input",16),t.NdJ("dateChange",function(p){return i.calcdates(p)}),t.qZA(),t._UZ(25,"mat-datepicker-toggle",17)(26,"mat-datepicker",null,18),t.qZA()(),t.TgZ(28,"div",8)(29,"label",19),t._uU(30,"Subscription Validity"),t.qZA(),t.TgZ(31,"mat-form-field",15),t._UZ(32,"input",20)(33,"mat-datepicker-toggle",17)(34,"mat-datepicker",null,21),t.qZA()(),t.TgZ(36,"div",8)(37,"label",22),t._uU(38,"Remaining Days"),t.qZA(),t._UZ(39,"input",23),t.qZA(),t.TgZ(40,"div",8)(41,"label",24),t._uU(42,"Purchase Id"),t.qZA(),t._UZ(43,"input",25),t.qZA(),t.TgZ(44,"div",8)(45,"label",26),t._uU(46,"Converted By"),t.qZA(),t.TgZ(47,"select",27),t.YNc(48,D,2,2,"option",11),t.qZA()()(),t.TgZ(49,"div",28),t.YNc(50,l,2,0,"button",29),t.YNc(51,_,2,0,"button",29),t.YNc(52,s,2,0,"button",30),t.qZA()()()),2&o){const u=t.MAs(27),p=t.MAs(35);t.xp6(2),t.Q6J("ngIf",!i.isEditMode),t.xp6(1),t.Q6J("ngIf",i.isEditMode),t.xp6(5),t.Q6J("formGroup",i.addcustomerForm),t.xp6(6),t.Q6J("ngForOf",i.leadList),t.xp6(5),t.Q6J("ngForOf",i.planList),t.xp6(5),t.Q6J("matDatepicker",u),t.xp6(1),t.Q6J("for",u),t.xp6(7),t.Q6J("matDatepicker",p)("disabled",!0),t.xp6(1),t.Q6J("for",p),t.xp6(15),t.Q6J("ngForOf",i.dzitraUserList),t.xp6(2),t.Q6J("ngIf",!i.isEditMode&&!i.readOnly&&!i.isInfoOnly),t.xp6(1),t.Q6J("ngIf",i.isEditMode&&!i.readOnly&&!i.isInfoOnly),t.xp6(1),t.Q6J("ngIf",i.isInfoOnly||i.readOnly)}},dependencies:[C.sg,C.O5,c.ZT,c.uh,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,h.Mq,h.hl,h.nW,y.KE,I.Nt],styles:[".mat-form-field-infix{display:contents!important}  .mat-form-field-underline{display:none!important}  .mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0!important}@media only screen and (max-width: 600px){.mat-form-field[_ngcontent-%COMP%]{display:block!important}}"]}),d})()},3575:(E,A,r)=>{r.d(A,{x:()=>D});var a=r(4006),c=r(5938),e=r(4650),t=r(5619),Z=r(6895),C=r(769);function h(l,_){1&l&&(e.TgZ(0,"h5",30),e._uU(1,"Add Plan"),e.qZA())}function y(l,_){1&l&&(e.TgZ(0,"h5",30),e._uU(1,"Plan Info"),e.qZA())}function I(l,_){if(1&l&&(e.TgZ(0,"option",31),e._uU(1),e.qZA()),2&l){const s=_.$implicit;e.Q6J("value",s._id),e.xp6(1),e.Oqu(s.name)}}function M(l,_){1&l&&(e.TgZ(0,"button",32),e._uU(1,"Add Plan"),e.qZA())}function T(l,_){1&l&&(e.TgZ(0,"button",32),e._uU(1,"Save"),e.qZA())}function v(l,_){if(1&l){const s=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(s);const d=e.oxw();return e.KtG(d.editinfo())}),e._uU(1,"Edit"),e.qZA()}}function O(l,_){1&l&&(e.TgZ(0,"button",34),e._uU(1," Close"),e.qZA())}let D=(()=>{class l{constructor(s,n,d,m){this.fb=s,this.http=n,this.dialogRef=d,this.inputData=m,this.isEditMode=!1,this.readOnly=!1,this.isInfoOnly=!1,this.value="0",this.limit=0,this.amountPrecisionOptions={align:"left",allowNegative:!1,allowZero:!0,decimal:".",precision:2,prefix:"",suffix:"",hundreds:"."}}ngOnInit(){this.addplanForm=this.fb.group({planname:["",a.kI.required],usercount:["",a.kI.required],dayscount:["",a.kI.required],remainder1:["",a.kI.required],remainder2:["",a.kI.required],plantypeid:["",a.kI.required],price:["",a.kI.required],internal_name:["",a.kI.required]}),this.inputData&&null!==this.inputData.id&&(this.planId=this.inputData.id,this.isEditMode=!0,this.getData()),this.inputData?.isReadonly&&(this.readOnly=!0,this.addplanForm.disable()),this.inputData?.isInfoscreen&&(this.isInfoOnly=!0,this.addplanForm.disable()),this.getPlanType()}getPlanType(){this.http.get("/plantype/all/active").subscribe(s=>{1==s.status&&(this.PlanTypes=s.data)})}getData(){this.http.get(`/plan/${this.planId}`).subscribe(s=>{if(1==s.status){let n=s.data;this.addplanForm.patchValue({planname:n.planname,usercount:n.usercount,dayscount:n.dayscount,remainder1:n.remainder1,remainder2:n.remainder2,plantypeid:n.plantypeid,price:n.price,internal_name:n.internal_name})}})}onSubmit(s){if(!s.valid)return;let n=s.value;this.planId?(n._id=this.planId,this.http.patch("/plan",n).subscribe(d=>{1==d.status&&this.dialogRef.close(1)})):this.http.post("/plan",n).subscribe(d=>{1==d.status&&this.dialogRef.close(1)})}editinfo(){this.addplanForm.enable(),this.isEditMode=!0,this.readOnly=!1}}return l.\u0275fac=function(s){return new(s||l)(e.Y36(a.qu),e.Y36(t.h),e.Y36(c.so),e.Y36(c.WI))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-plan-modal"]],decls:48,vars:10,consts:[[1,"row"],[1,"dialogue-head","col-md-8"],["mat-dialog-title","",4,"ngIf"],[1,"close-Btns","col-md-4"],[1,"card","close-Card",3,"mat-dialog-close"],["src","../../../../../assets/image/fi_x.png","alt",""],[1,"addform-container"],[3,"formGroup","ngSubmit"],[1,"col-md-6"],["for","planname",1,"dialogue-label"],["type","text","formControlName","planname","name","planname",1,"w-100","input-Class"],["for","usercount",1,"dialogue-label"],["type","text","formControlName","usercount","name","usercount",1,"w-100","input-Class"],["for","dayscount",1,"dialogue-label"],["type","text","formControlName","dayscount","name","dayscount",1,"w-100","input-Class"],["for","remainder1",1,"dialogue-label"],["type","text","formControlName","remainder1","name","remainder1",1,"w-100","input-Class"],["for","remainder2",1,"dialogue-label"],["type","text","formControlName","remainder2","name","remainder2",1,"w-100","input-Class"],["for","plantypeid",1,"dialogue-label"],["formControlName","plantypeid","name","plantypeid",1,"w-100","input-Class"],[3,"value",4,"ngFor","ngForOf"],["for","price",1,"dialogue-label"],["type","text","formControlName","price","name","price","name","sumInsuredLimit","id","field_sumInsuredLimit","currencyMask","","required","",1,"form-control",3,"ngModel","options","ngModelChange"],["for","internal_name",1,"dialogue-label"],["type","text","formControlName","internal_name","name","internal_name",1,"w-100","input-Class"],[1,"button","col-md-12"],["type","submit","class","createLead-Btns",4,"ngIf"],["type","submit","class","createLead-Btns",3,"click",4,"ngIf"],["type","submit","class","createLead-Btns",3,"mat-dialog-close",4,"ngIf"],["mat-dialog-title",""],[3,"value"],["type","submit",1,"createLead-Btns"],["type","submit",1,"createLead-Btns",3,"click"],["type","submit",1,"createLead-Btns",3,"mat-dialog-close"]],template:function(s,n){1&s&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,h,2,0,"h5",2),e.YNc(3,y,2,0,"h5",2),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._UZ(6,"img",5),e.qZA()()(),e.TgZ(7,"div",6)(8,"form",7),e.NdJ("ngSubmit",function(){return n.onSubmit(n.addplanForm)}),e.TgZ(9,"div",0)(10,"div",8)(11,"label",9),e._uU(12,"Plan Name"),e.qZA(),e._UZ(13,"input",10),e.qZA(),e.TgZ(14,"div",8)(15,"label",11),e._uU(16,"User Count"),e.qZA(),e._UZ(17,"input",12),e.qZA(),e.TgZ(18,"div",8)(19,"label",13),e._uU(20,"Days Count"),e.qZA(),e._UZ(21,"input",14),e.qZA(),e.TgZ(22,"div",8)(23,"label",15),e._uU(24,"Reminder 1"),e.qZA(),e._UZ(25,"input",16),e.qZA(),e.TgZ(26,"div",8)(27,"label",17),e._uU(28,"Reminder 2"),e.qZA(),e._UZ(29,"input",18),e.qZA(),e.TgZ(30,"div",8)(31,"label",19),e._uU(32,"Plan Type"),e.qZA(),e.TgZ(33,"select",20),e.YNc(34,I,2,2,"option",21),e.qZA()(),e.TgZ(35,"div",8)(36,"label",22),e._uU(37,"Price"),e.qZA(),e.TgZ(38,"input",23),e.NdJ("ngModelChange",function(m){return n.sumInsuredLimitModel=m}),e.qZA()(),e.TgZ(39,"div",8)(40,"label",24),e._uU(41,"Internal Name"),e.qZA(),e._UZ(42,"input",25),e.qZA()(),e.TgZ(43,"div",26),e.YNc(44,M,2,0,"button",27),e.YNc(45,T,2,0,"button",27),e.YNc(46,v,2,0,"button",28),e.YNc(47,O,2,0,"button",29),e.qZA()()()),2&s&&(e.xp6(2),e.Q6J("ngIf",!n.isEditMode),e.xp6(1),e.Q6J("ngIf",n.isEditMode),e.xp6(5),e.Q6J("formGroup",n.addplanForm),e.xp6(26),e.Q6J("ngForOf",n.PlanTypes),e.xp6(4),e.Q6J("ngModel",n.sumInsuredLimitModel)("options",n.amountPrecisionOptions),e.xp6(6),e.Q6J("ngIf",!n.isEditMode&&!n.readOnly&&!n.isInfoOnly),e.xp6(1),e.Q6J("ngIf",n.isEditMode&&!n.readOnly&&!n.isInfoOnly),e.xp6(1),e.Q6J("ngIf",n.readOnly),e.xp6(1),e.Q6J("ngIf",n.isInfoOnly))},dependencies:[Z.sg,Z.O5,c.ZT,c.uh,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.Q7,a.sg,a.u,C.g1]}),l})()}}]);